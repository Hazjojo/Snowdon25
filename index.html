<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snowdon: A Living Planet Expedition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f8f4;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 40vh;
            max-height: 400px;
        }
        .brand-text { color: #008744; }
        .accent-text { color: #0057b7; }
        .highlight-bg { background-color: #0057b7; }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 4px, 6px, 0.05);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        .action-button {
            display: inline-block;
            padding: 0.75rem 1.5rem;
            background-color: #0057b7;
            color: white;
            font-weight: bold;
            border-radius: 0.5rem;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
            text-align: center;
        }
        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
    </style>
</head>
<body class="text-gray-800">

    <header class="highlight-bg text-white text-center py-12 px-4">
        <h1 class="text-4xl md:text-6xl font-black tracking-tight leading-tight">Snowdon: A Living Planet Expedition</h1>
        <p class="mt-4 text-lg md:text-xl text-blue-100">The Ascent of Giants &ndash; August 24th, 2025</p>
    </header>

    <main class="container mx-auto p-4 md:p-8">

        <section id="introduction" class="card text-center">
            <h2 class="text-3xl font-bold brand-text mb-4">The Daring Ascent</h2>
            <p class="text-lg leading-relaxed">A new chapter in our journey begins. A small, determined troop prepares to travel north, drawn by an ancient instinct towards the colossal volcanic massif of Snowdonia. This is a pilgrimage not of necessity, but of spirit—a quest to stand upon the roof of Wales.</p>
        </section>

        <section id="timeline" class="card">
            <h2 class="text-3xl font-bold brand-text text-center mb-6">The Expedition Timeline</h2>
            <div class="relative border-l-4 border-emerald-300 ml-4 md:ml-0">
                
                <div class="mb-8 ml-8">
                    <div class="absolute w-8 h-8 highlight-bg rounded-full -left-4 border-4 border-white"></div>
                    <p class="text-sm accent-text font-bold">06:15 AM</p>
                    <h3 class="text-xl font-bold brand-text">Meetup at Basecamp Shrewsbury</h3>
                    <p class="mt-1">All members convene at the rendezvous point: <strong>21 Brookside, Shrewsbury, SY3 8EP</strong>. A final check of equipment ensures readiness for the challenges ahead.</p>
                </div>

                <div class="mb-8 ml-8">
                    <div class="absolute w-8 h-8 highlight-bg rounded-full -left-4 border-4 border-white"></div>
                    <p class="text-sm accent-text font-bold">08:15 AM</p>
                    <h3 class="text-xl font-bold brand-text">Arrival at Pen-y-Pass</h3>
                    <p class="mt-1">The expedition arrives at the trailhead: <strong>LL55 4NU</strong>. A precise 20-minute window for final preparations before venturing into the wild.</p>
                </div>
                
                <div class="mb-8 ml-8">
                    <div class="absolute w-8 h-8 highlight-bg rounded-full -left-4 border-4 border-white"></div>
                    <p class="text-sm accent-text font-bold">08:35 AM</p>
                    <h3 class="text-xl font-bold brand-text">The Ascent Commences</h3>
                    <p class="mt-1">The journey begins on the Miners' Track, a path of gentle gravel leading past the serene lakes of Llyn Teyrn and Llyn Llydaw. The route follows the old tramway, a testament to the mining history of the region. The initial cinematic approach gradually gives way to a final, steep scramble to the summit, a true test of resolve.</p>
                </div>

                <div class="mb-8 ml-8">
                    <div class="absolute w-8 h-8 highlight-bg rounded-full -left-4 border-4 border-white"></div>
                    <p class="text-sm accent-text font-bold">~12:05 PM</p>
                    <h3 class="text-xl font-bold brand-text">The Summit</h3>
                    <p class="mt-1">The pinnacle is reached. At 1,085 meters above sea level, you are on the roof of Wales. The summit offers breathtaking 360-degree views, a chance to see the Snowdon Horseshoe, and a well-deserved rest at the Hafod Eryri café. It is a world above our own, a place where ancient geology and unique flora, like the rare Snowdon Lily, converge.</p>
                </div>

                <div class="mb-8 ml-8">
                    <div class="absolute w-8 h-8 highlight-bg rounded-full -left-4 border-4 border-white"></div>
                    <p class="text-sm accent-text font-bold">~01:20 PM</p>
                    <h3 class="text-xl font-bold brand-text">The Descent</h3>
                    <p class="mt-1">A new challenge awaits as the expedition begins the descent via the rugged Pyg Track. This path is steeper from the outset, a winding route of rocky steps and loose scree that demands careful footwork. It provides a different, more challenging perspective on the mountain's raw, untamed beauty as you navigate your way back to the valley floor.</p>
                </div>

                <div class="ml-8">
                    <div class="absolute w-8 h-8 highlight-bg rounded-full -left-4 border-4 border-white"></div>
                    <p class="text-sm accent-text font-bold">~04:30 PM</p>
                    <h3 class="text-xl font-bold brand-text">Mission Accomplished</h3>
                    <p class="mt-1">Return to Pen-y-Pass, the mountain's secrets witnessed, its challenge met.</p>
                </div>

            </div>
        </section>
        
        <section id="routes" class="card">
            <h2 class="text-3xl font-bold brand-text text-center mb-4">The Tale of Two Paths</h2>
            <p class="text-lg text-center leading-relaxed mb-6">The circular route presents two distinct challenges, each with its own character. The Miners' Track offers a gentle, cinematic prelude before its fierce final climb, while the Pyg Track is a relentless, rugged test from the start. This comparison reveals the nature of the day's journey.</p>
            <div class="chart-container">
                <canvas id="routeComparisonChart"></canvas>
            </div>
            <h2 class="text-3xl font-bold brand-text text-center mt-8 mb-4">Expedition Elevation Profile</h2>
            <p class="text-lg text-center leading-relaxed mb-6">This chart illustrates the changing elevation throughout the journey, from the gradual climb of the Miners' Track to the steep descent of the Pyg Track, providing a clear picture of the physical challenge.</p>
            <div class="chart-container">
                <canvas id="elevationProfileChart"></canvas>
            </div>
        </section>

        <section id="summit" class="grid md:grid-cols-2 gap-8 items-center">
            <div class="card md:col-span-1">
                <h2 class="text-3xl font-bold brand-text mb-4">The Summit: 1,085m</h2>
                <p class="text-lg leading-relaxed">At last, the summit of Yr Wyddfa. This is a world above our own, a high-altitude ecosystem where only the hardiest life survives. The Snowdon Lily, a rare arctic-alpine plant, clings to existence here, a fragile jewel in a crown of ancient volcanic rock. The views, on a clear day, are simply breathtaking—a panoramic reward for hours of relentless effort.</p>
                <div class="mt-4">
                    <button id="generateFactBtn" class="action-button w-full">
                        Generate New Snowdon Fact ✨
                    </button>
                    <div id="fun-fact-output" class="mt-4 p-4 bg-gray-50 rounded-lg text-sm text-gray-700 hidden"></div>
                </div>
            </div>
            <div class="card md:col-span-1 text-center">
                <h3 class="text-2xl font-bold accent-text">Key Expedition Data</h3>
                <div class="mt-4">
                    <p class="text-5xl font-black brand-text">12.5</p>
                    <p class="text-lg accent-text">Kilometers Travelled</p>
                </div>
                <div class="mt-6">
                    <p class="text-5xl font-black brand-text">723</p>
                    <p class="text-lg accent-text">Meters of Ascent</p>
                </div>
                <div class="mt-6">
                    <p class="text-5xl font-black brand-text">~8</p>
                    <p class="text-lg accent-text">Hours on the Mountain</p>
                </div>
                <div class="mt-8">
                    <button id="generateListBtn" class="action-button w-full">
                        Generate Packing List ✨
                    </button>
                    <div id="packing-list-output" class="mt-4 p-4 bg-gray-50 rounded-lg text-sm text-left text-gray-700 hidden"></div>
                </div>
            </div>
        </section>

        <section id="call-to-action" class="card text-center mt-12">
            <h2 class="text-3xl font-bold brand-text mb-4">Join the Expedition</h2>
            <p class="text-lg leading-relaxed mb-4">If you are interested in joining this daring expedition, please contact Harry Owens to coordinate your participation.</p>
            <h2 class="text-3xl font-bold brand-text mb-4">Secure Your Parking</h2>
            <a href="https://www.justpark.com/uk/parking/caernarfon/s/llanberis-caernarfon-ll55-4nu/?fixed_start=2025-08-24T09%3A00&fixed_end=2025-08-24T16%3A00" 
               target="_blank" 
               class="action-button"
               role="button">
                Book Parking Now
            </a>
        </section>

        <footer class="text-center mt-12 text-gray-500">
            <p>A document chronicling Captain Clive's daring expedition into the wild heart of Eryri.</p>
        </footer>

    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Chart.js script for Route Comparison
            const ctxRoute = document.getElementById('routeComparisonChart').getContext('2d');
            new Chart(ctxRoute, {
                type: 'bar',
                data: {
                    labels: ['Miners\' Track (Ascent)', 'Pyg Track (Descent)'],
                    datasets: [{
                        label: 'Perceived Difficulty (out of 10)',
                        data: [6, 8],
                        backgroundColor: ['#008744', '#0057b7'],
                        borderColor: ['#008744', '#0057b7'],
                        borderWidth: 1
                    }, {
                        label: 'Distance (km)',
                        data: [6.5, 5.5],
                        backgroundColor: ['rgba(0, 135, 68, 0.5)', 'rgba(0, 87, 183, 0.5)'],
                        borderColor: ['#008744', '#0057b7'],
                        borderWidth: 1
                    }]
                },
                options: {
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: '#0057b7'
                            },
                            grid: {
                                color: '#e0e6eb'
                            }
                        },
                        x: {
                           ticks: {
                                color: '#0057b7',
                                font: {
                                    weight: 'bold'
                                }
                            },
                            grid: {
                                display: false
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: '#0057b7'
                            }
                        },
                        tooltip: {
                            callbacks: {
                                title: function(tooltipItems) {
                                    const item = tooltipItems[0];
                                    let label = item.chart.data.labels[item.dataIndex];
                                    if (Array.isArray(label)) {
                                      return label.join(' ');
                                    } else {
                                      return label;
                                    }
                                }
                            }
                        }
                    }
                }
            });

            // Chart.js script for Elevation Profile
            const ctxElevation = document.getElementById('elevationProfileChart').getContext('2d');
            new Chart(ctxElevation, {
                type: 'line',
                data: {
                    labels: ['Start', 'Llyn Teyrn', 'Llyn Llydaw', 'Miners\' Track End', 'Summit', 'Pyg Track Start', 'Descent Midpoint', 'Return'],
                    datasets: [{
                        label: 'Elevation (meters)',
                        data: [360, 420, 440, 700, 1085, 1085, 750, 360],
                        fill: {
                            target: 'origin',
                            above: 'rgba(0, 87, 183, 0.3)'
                        },
                        borderColor: '#0057b7',
                        tension: 0.4,
                        pointBackgroundColor: '#008744',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#0057b7',
                        pointHoverBorderColor: '#008744'
                    }]
                },
                options: {
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Elevation (m)',
                                color: '#0057b7'
                            },
                            ticks: {
                                color: '#0057b7'
                            },
                            grid: {
                                color: '#e0e6eb'
                            }
                        },
                        x: {
                           title: {
                                display: true,
                                text: 'Expedition Milestones',
                                color: '#0057b7'
                            },
                            ticks: {
                                color: '#0057b7',
                                font: {
                                    weight: 'bold'
                                }
                            },
                            grid: {
                                display: false
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });

            // Gemini API Integration
            const generateListBtn = document.getElementById('generateListBtn');
            const packingListOutput = document.getElementById('packing-list-output');
            const generateFactBtn = document.getElementById('generateFactBtn');
            const funFactOutput = document.getElementById('fun-fact-output');
            
            // Function for exponential backoff retry logic
            const withExponentialBackoff = async (func, maxRetries = 5, delay = 1000) => {
                for (let i = 0; i < maxRetries; i++) {
                    try {
                        return await func();
                    } catch (error) {
                        if (i === maxRetries - 1) {
                            throw error;
                        }
                        await new Promise(res => setTimeout(res, delay * Math.pow(2, i)));
                    }
                }
            };

            // Generate Packing List
            generateListBtn.addEventListener('click', async () => {
                generateListBtn.disabled = true;
                packingListOutput.classList.remove('hidden');
                packingListOutput.innerHTML = '<p class="text-center animate-pulse">Generating your packing list...</p>';
                
                try {
                    const prompt = `Based on a hiking expedition on Snowdon (Yr Wyddfa) in Wales, which is 12.5 kilometers long, involves a 723 meter ascent, and takes about 8 hours, please generate a comprehensive packing list. Organize the list into categories such as "Clothing", "Equipment", "Food & Drink", and "Safety & Navigation". For each category, provide a list of specific items.`;
                    
                    const chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                    const payload = {
                        contents: chatHistory,
                        generationConfig: {
                            responseMimeType: "application/json",
                            responseSchema: {
                                type: "ARRAY",
                                items: {
                                    type: "OBJECT",
                                    properties: {
                                        "category": { "type": "STRING" },
                                        "items": { "type": "ARRAY", "items": { "type": "STRING" } }
                                    }
                                }
                            }
                        }
                    };
                    
                    const apiKey = "AIzaSyB_lww3ajaVceKaEX2X3bF7lB_bDpWeCoM";
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                    const response = await withExponentialBackoff(() => fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    }));

                    const result = await response.json();
                    
                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        const json = result.candidates[0].content.parts[0].text;
                        const parsedJson = JSON.parse(json);
                        
                        let html = '';
                        parsedJson.forEach(cat => {
                            html += `<h4 class="font-bold text-lg text-emerald-700 mt-4 mb-2">${cat.category}</h4>`;
                            html += '<ul class="list-disc list-inside space-y-1">';
                            cat.items.forEach(item => {
                                html += `<li>${item}</li>`;
                            });
                            html += '</ul>';
                        });
                        packingListOutput.innerHTML = html;
                    } else {
                        packingListOutput.innerHTML = '<p class="text-red-500">Error: Could not generate packing list. Please try again.</p>';
                    }
                } catch (error) {
                    console.error('Error generating packing list:', error);
                    packingListOutput.innerHTML = '<p class="text-red-500">An error occurred. Please check the console for details.</p>';
                } finally {
                    generateListBtn.disabled = false;
                }
            });

            // Generate Fun Fact
            generateFactBtn.addEventListener('click', async () => {
                generateFactBtn.disabled = true;
                funFactOutput.classList.remove('hidden');
                funFactOutput.innerHTML = '<p class="text-center animate-pulse">Fetching a fun fact...</p>';

                try {
                    const prompt = `Provide a single, interesting, and concise fun fact about Snowdon (Yr Wyddfa), covering its history, geology, or local legends.`;
                    
                    const chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                    const payload = { contents: chatHistory };
                    
                    const apiKey = "";
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                    const response = await withExponentialBackoff(() => fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    }));
                    
                    const result = await response.json();

                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        const text = result.candidates[0].content.parts[0].text;
                        funFactOutput.innerHTML = text;
                    } else {
                        funFactOutput.innerHTML = '<p class="text-red-500">Error: Could not generate fun fact. Please try again.</p>';
                    }
                } catch (error) {
                    console.error('Error generating fun fact:', error);
                    funFactOutput.innerHTML = '<p class="text-red-500">An error occurred. Please check the console for details.</p>';
                } finally {
                    generateFactBtn.disabled = false;
                }
            });
        });
    </script>
</body>
</html>
